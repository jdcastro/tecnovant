{% extends "base.j2" %}
{% set dashboard = true %}
{% from "settings/_ui_class.j2" import base_button_classes, input_bg_color, border_color, hover_bg_color,
focus_ring_color, button_bg_color, delete_button_bg_color, input_focus_bg_color, text_color %}
{% set data_menu = {
"menu": [
{"name": "Home", "url": url_for('core.index') },
{"name": "Logout", "url": url_for('core.logout') },
{"name": "Profile", "url": url_for('core.profile') }
]
} %}
{% set title = "Dashboard" %}
{% block content %}

<div class="mx-auto max-w-8xl py-6 sm:px-6 lg:px-8">
    <!-- Encabezado del Perfil -->
    <div class="relative mb-8">
        <!-- Imagen de portada -->
        <div class="h-48 bg-gradient-to-r from-blue-600 to-purple-600 rounded-t-lg"></div>

        <!-- Avatar -->
        <div class="absolute -bottom-10 left-4">
            <img src="/img/avatar.png" alt="Avatar" class="w-32 h-32 rounded-full border-4 border-white">
            {# <button class="mt-2 w-24 {{ base_button_classes }} {{ button_bg_color }} text-white {{ focus_ring_color }}">
                Subir Foto
            </button> #}
        </div>

        <!-- Nombre y título -->
        <div class="absolute -bottom-10 left-40">
            <h1 class="text-2xl font-bold {{ text_color }}">{{ full_name }}</h1>
            <p class="text-lg {{ text_color }}">{{ username }}</p>
        </div>
    </div>

    <!-- Sección Perfil de Usuario -->
    <div class="bg-white rounded-lg shadow p-6 mb-6">
        <h2 class="text-xl font-semibold mb-4">Perfil de Usuario</h2>
        <form id="profileForm">
            <!-- Campos del formulario -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium {{ text_color }}">{{ username }}</label>
                    <input type="text" id="username"
                        class="{{ base_input_classes }} {{ input_bg_color }} {{ border_color }}" disabled
                        value="{{ username }}">
                </div>
                <div>
                    <label class="block text-sm font-medium {{ text_color }}">{{ full_name }}</label>
                    <input type="text" id="name"
                        class="{{ base_input_classes }} {{ input_bg_color }} {{ border_color }}"
                        value="{{ full_name }}">
                    <p class="text-ls {{ text_color }}">Rol: {{ role }} </p>
                    <p class="text-ls {{ text_color }}">Cliente: {{ client }}</p>
                </div>
                <!-- Otros campos -->
                <div>
                    <label class="block text-sm font-medium {{ text_color }}">{{ email }}</label>
                    <input type="email" id="email"
                        class="{{ base_input_classes }} {{ input_bg_color }} {{ border_color }}" value="{{ email }}">
                </div>
                <!-- Agrega los demás campos según las secciones -->
            </div>
            <button type="submit" class="{{ base_button_classes }} {{ button_bg_color }} text-white mt-4">Actualizar
                Perfil</button>
        </form>

    </div>

    <!-- Sección Cambio de Contraseña -->
    <div class="bg-white rounded-lg shadow p-6 mb-6">
        <h2 class="text-xl font-semibold mb-4">Cambiar Contraseña</h2>
        <form id="passwordForm">
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium {{ text_color }}">Contraseña Actual</label>
                    <input type="password" class="{{ base_input_classes }} {{ input_bg_color }} {{ border_color }}">
                </div>
                <div>
                    <label class="block text-sm font-medium {{ text_color }}">Nueva Contraseña</label>
                    <input type="password" class="{{ base_input_classes }} {{ input_bg_color }} {{ border_color }}">
                </div>
                <div>
                    <label class="block text-sm font-medium {{ text_color }}">Confirmar Contraseña</label>
                    <input type="password" class="{{ base_input_classes }} {{ input_bg_color }} {{ border_color }}">
                </div>
                <button type="submit" class="{{ base_button_classes }} {{ button_bg_color }} text-white">Actualizar
                    Contraseña</button>
            </div>
        </form>
    </div>

    <!-- Sección Notificaciones -->
    <div class="bg-white rounded-lg shadow p-6">
        <h2 class="text-xl font-semibold mb-4">Notificaciones</h2>
        <div class="space-y-4">
            <div class="space-y-2">
                <h3 class="text-sm font-medium {{ text_color }}">Preferencias de Correo</h3>
                <div class="space-y-1">
                    <label class="flex items-center">
                        <input type="checkbox" class="h-4 w-4 text-blue-600">
                        <span class="ml-2 text-sm {{ text_color }}">Relativas a la cuenta</span>
                    </label>
                    <!-- Otros checkboxes -->
                </div>
            </div>
            <div>
                <button class="{{ base_button_classes }} {{ button_bg_color }} text-white">Actualizar
                    Preferencias</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Funcionalidad para editar
        document.getElementById('editButton').addEventListener('click', function () {
            const form = document.getElementById('profileForm');
            const inputs = form.querySelectorAll('input');
            inputs.forEach(input => {
                if (input.id !== 'username') input.removeAttribute('disabled');
            });
            this.style.display = 'none';
            document.getElementById('saveButton').style.display = 'inline-block';
        });

        // Funcionalidad para guardar
        document.getElementById('saveButton').addEventListener('click', function (e) {
            e.preventDefault();
            const formData = new FormData(document.getElementById('profileForm'));
            fetch('/api/update-profile', {
                method: 'POST',
                body: formData
            }).then(response => {
                if (response.ok) {
                    alert('Perfil actualizado correctamente');
                }
            });
        });
    });
</script>
{% endblock %}